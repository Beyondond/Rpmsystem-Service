<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace = "cn.com.dhc.rpmsystem.system.dao.AuthorityDao">
    <resultMap id="BaseResultMap" type="cn.com.dhc.rpmsystem.system.dto.MemberRole">
        <result column="id" jdbcType="INTEGER" property="id"/>
        <result column="role_name" jdbcType="VARCHAR" property="roleName"/>
        <result column="skills" jdbcType="VARCHAR" property="skills"/>
        <result column="created_num_uid" jdbcType="VARCHAR" property="createNumUid"/>
        <result column="colum_name" jdbcType="VARCHAR" property="columName"/>
        <result column="created_time" jdbcType="VARCHAR" property="created_time"/>
        <result column="num_uid" jdbcType="INTEGER" property="numUid"/>
        <result column="mem_name" jdbcType="VARCHAR" property="memName"/>
        <result column="role_ids" jdbcType="VARCHAR" property="roleIds"/>
        <result column="password" jdbcType="VARCHAR" property="password"/>
        <result column="column_show" jdbcType="VARCHAR" property="columnShow"/>
        <result column="created_num_uid" jdbcType="VARCHAR" property="createdNumUid"/>
        <result column="created_time" jdbcType="VARCHAR" property="createdTime"/>
    </resultMap>

    <!--删除一个权限-->
    <delete id="deleteSkillInfo" parameterType="integer">
        DELETE FROM rpm_role
        WHERE id = #{id}
    </delete>
    <!--编辑更新权限-->
    <update id="updateSkillInfo"   parameterType="cn.com.dhc.rpmsystem.system.dto.MemberRole">
        UPDATE  rpm_role r
        INNER JOIN  rpm_member_role m ON r.id
        = m.role_ids AND  m.mem_name = #{memName}
        SET r.role_name = #{roleName};
    </update>
    <!-- 查询所有人员权限-->
    <select id="findAllSkillInfo" resultMap="BaseResultMap"  resultType="cn.com.dhc.rpmsystem.system.dto.MemberRole">
        SELECT  id ,num_uid , mem_name, role_name
        FROM rpm_member_role AS m
        INNER JOIN rpm_role AS r
        ON m.role_ids = r.id
    </select>

    <!--根据名称查找权限-->
    <select id="findOneSkillInfo" resultMap="BaseResultMap" resultType="cn.com.dhc.rpmsystem.system.dto.MemberRole">
        SELECT  id ,num_uid ,mem_name,role_name
        FROM rpm_member_role AS m
        INNER JOIN rpm_role AS r
        ON m.role_ids = r.id
        WHERE
          m.mem_name = #{memName}
    </select>
</mapper>